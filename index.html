<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>7-Gaben-HÃ¼gel â€¢ Simulation of Charismata</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
    <style>
        /* VANVA / Canva-style Aesthetics */
        body { 
            background: radial-gradient(circle at 50% 10%, #1e1e2f 0%, #000000 100%); 
            color: #e0e0e0; 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow-x: hidden;
        }
        
        /* Glow Effects */
        .glow-text { text-shadow: 0 0 20px rgba(234, 179, 8, 0.7); }
        .glow-box { box-shadow: 0 0 30px rgba(234, 179, 8, 0.2); transition: all 0.3s ease; }
        .glow-box:hover { box-shadow: 0 0 50px rgba(234, 179, 8, 0.5); transform: translateY(-5px); }

        /* Canvas Styling */
        #gameCanvas { 
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid #eab308; 
            border-radius: 24px;
            box-shadow: 0 0 60px rgba(234, 179, 8, 0.15); 
            cursor: crosshair;
        }

        /* Animations */
        @keyframes float { 0% { transform: translateY(0px); } 50% { transform: translateY(-10px); } 100% { transform: translateY(0px); } }
        .floating { animation: float 6s ease-in-out infinite; }
        
        /* Utility */
        .locked { filter: grayscale(100%) opacity(0.3); pointer-events: none; }
        .unlocked { filter: grayscale(0%) opacity(1); border-color: #10b981 !important; background: rgba(6, 78, 59, 0.3) !important; }
        
        /* ReverbNation Widget Responsive */
        .music-container iframe { border-radius: 16px; box-shadow: 0 0 40px rgba(168, 85, 247, 0.4); }
    </style>
</head>
<body class="min-h-screen flex flex-col">

  <!-- Navbar -->
  <nav class="backdrop-blur-md bg-black/60 border-b border-white/10 sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
      <div class="flex items-center gap-4">
        <i class="fa-solid fa-church text-3xl text-yellow-400 glow-text"></i>
        <span class="text-2xl font-bold tracking-wider text-white">ROSARY<span class="text-yellow-400">-mom</span></span>
      </div>
      <div class="hidden md:block text-sm text-yellow-400/80 uppercase tracking-widest">
        Simulation of Charismata v2.0
      </div>
      <a href="https://github.com/Rosary-mom" target="_blank" class="hover:text-white text-gray-400 transition">
        <i class="fa-brands fa-github text-2xl"></i>
      </a>
    </div>
  </nav>

  <!-- Hero Section -->
  <header class="max-w-4xl mx-auto px-6 py-16 text-center">
    <h1 class="text-5xl md:text-7xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-yellow-200 via-yellow-400 to-yellow-600 mb-6 floating">
      7-Gaben-HÃ¼gel
    </h1>
    <p class="text-xl md:text-2xl text-gray-300 mb-10 font-light">
      Emergent Freiheits-Engine â€¢ Entdecke die Charismen
    </p>

    <!-- Score Board -->
    <div class="inline-flex items-center gap-6 bg-white/5 border border-white/10 rounded-full px-8 py-4 glow-box">
      <div class="text-right">
        <p class="text-xs text-gray-400 uppercase tracking-wider">VELOLoop Score</p>
        <p id="velo-score" class="text-4xl font-bold text-emerald-400 font-mono">700</p>
      </div>
      <div class="h-10 w-px bg-white/20"></div>
      <div class="text-left">
        <p class="text-xs text-gray-400 uppercase tracking-wider">Gaben gefunden</p>
        <p id="found-count" class="text-4xl font-bold text-yellow-400 font-mono">0/7</p>
      </div>
    </div>
  </header>

  <!-- Main Game Area -->
  <main class="flex-grow">
    
    <!-- Canvas Simulation -->
    <section class="max-w-6xl mx-auto px-4 mb-20">
      <div class="relative w-full flex justify-center">
        <canvas id="gameCanvas" width="1000" height="700" class="max-w-full h-auto"></canvas>
        
        <!-- Overlay Instruction -->
        <div id="start-hint" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-center pointer-events-none transition-opacity duration-1000">
          <p class="text-yellow-200 bg-black/80 px-4 py-2 rounded-lg border border-yellow-500/30">
            Klicke auf die Symbole, um die Gaben zu empfangen
          </p>
        </div>
      </div>
    </section>

    <!-- Transcribed Charismata Grid (Explorer Mode) -->
    <section id="explorer-section" class="max-w-7xl mx-auto px-6 py-16 bg-gradient-to-b from-transparent to-black/80">
      <div class="flex items-center gap-4 mb-12">
        <div class="h-px bg-yellow-500/50 flex-grow"></div>
        <h2 class="text-3xl md:text-4xl font-bold text-center text-yellow-100">
          <i class="fa-solid fa-scroll text-yellow-500 mr-3"></i> Transkribierte Charismen
        </h2>
        <div class="h-px bg-yellow-500/50 flex-grow"></div>
      </div>

      <div id="charisma-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
        <!-- Cards injected via JS -->
      </div>
    </section>

    <!-- Music Integration -->
    <section class="max-w-4xl mx-auto px-6 py-20 text-center">
        <h3 class="text-2xl font-bold text-purple-400 mb-8 glow-text">AtmosphÃ¤re & Hymne</h3>
        <div class="music-container">
            <iframe width="100%" height="250" scrolling="no" frameborder="no"
                src="https://www.reverbnation.com/widget_code/html_widget/artist_41970?widget_id=55&pwc[included_songs]=1&context_type=page_object"
                style="width:100%;min-width:100%;max-width:100%;"></iframe>
        </div>
    </section>

  </main>

  <!-- Footer -->
  <footer class="border-t border-white/10 bg-black py-10 text-center">
    <p class="text-gray-500 text-sm">
      Â© 2026 Rosary Parish â€¢ Simulation of Charismata Repo <br>
      Built with <i class="fa-solid fa-heart text-red-900"></i> for the 7-Gaben-HÃ¼gel
    </p>
  </footer>

  <!-- Audio Resources -->
  <audio id="sfx-bell" src="https://freesound.org/data/previews/339/339810_5121236-lq.mp3"></audio>
  <audio id="sfx-win" src="https://freesound.org/data/previews/270/270402_5123854-lq.mp3"></audio>

  <!-- Game Engine Script -->
  <script>
    /**
     * DATA: Transcribed from Rosary Parish Blog
     * This replaces the external JSON fetch for stability.
     */
    const CHARISMA_DATA = [
        {
            id: "weisheit",
            name: "Weisheit",
            icon: "ðŸ•Šï¸",
            pos: { x: 500, y: 100 }, // Top of hill
            stats: { grace: 50, cost: 0 },
            text: "Die Gabe, das Leben aus der Perspektive Gottes zu sehen. Sie schenkt den 'Geschmack' fÃ¼r das GÃ¶ttliche und ordnet alle anderen Erkenntnisse."
        },
        {
            id: "einsicht",
            name: "Einsicht",
            icon: "ðŸ‘ï¸",
            pos: { x: 350, y: 250 },
            stats: { grace: 40, cost: 0 },
            text: "Der durchdringende Blick fÃ¼r die Glaubenswahrheiten. Nicht bloÃŸes intellektuelles Verstehen, sondern das Erfassen des inneren Sinnes."
        },
        {
            id: "rat",
            name: "Rat",
            icon: "âš–ï¸",
            pos: { x: 650, y: 250 },
            stats: { grace: 35, cost: 0 },
            text: "Die intuitive FÃ¤higkeit, in komplexen Situationen das Richtige zu tun. Gott selbst wird zum Berater des Herzens."
        },
        {
            id: "staerke",
            name: "StÃ¤rke",
            icon: "ðŸ›¡ï¸",
            pos: { x: 250, y: 450 },
            stats: { grace: 45, cost: 0 },
            text: "Mut und Ausdauer im Guten. Die Kraft, WiderstÃ¤nde zu Ã¼berwinden und dem BÃ¶sen standzuhalten, auch unter Schwierigkeiten."
        },
        {
            id: "erkenntnis",
            name: "Erkenntnis",
            icon: "ðŸ’¡",
            pos: { x: 750, y: 450 },
            stats: { grace: 30, cost: 0 },
            text: "Die FÃ¤higkeit, die SchÃ¶pfung richtig zu bewerten und ihren Bezug zum SchÃ¶pfer zu erkennen. Das Wahre vom Falschen unterscheiden."
        },
        {
            id: "froemmigkeit",
            name: "FrÃ¶mmigkeit",
            icon: "ðŸ™",
            pos: { x: 350, y: 600 },
            stats: { grace: 25, cost: 0 },
            text: "Eine kindliche Zuneigung zu Gott. Es ist keine Ã¤uÃŸere PflichtÃ¼bung, sondern eine Herzenshaltung der Verbundenheit."
        },
        {
            id: "gottesfurcht",
            name: "Gottesfurcht",
            icon: "ðŸ”¥",
            pos: { x: 650, y: 600 },
            stats: { grace: 20, cost: 0 },
            text: "Ehrfurcht vor der GrÃ¶ÃŸe Gottes. Nicht Angst vor Strafe, sondern Sorge, die Liebe Gottes durch SÃ¼nde zu verletzen."
        }
    ];

    // Game State
    const state = {
        score: 700,
        found_ids: [],
        particles: []
    };

    // Canvas Setup
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    // --- RENDERING ENGINE ---

    function drawHill() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // 1. Draw Paths (Connections)
        ctx.beginPath();
        ctx.strokeStyle = "rgba(234, 179, 8, 0.2)";
        ctx.lineWidth = 4;
        
        // Simple hierarchy connections
        const connections = [
            [0,1], [0,2], // Weisheit -> Einsicht, Rat
            [1,3], [1,5], // Left Branch
            [2,4], [2,6]  // Right Branch
        ];

        connections.forEach(pair => {
            const start = CHARISMA_DATA[pair[0]].pos;
            const end = CHARISMA_DATA[pair[1]].pos;
            ctx.moveTo(start.x, start.y);
            ctx.lineTo(end.x, end.y);
        });
        ctx.stroke();

        // 2. Draw Nodes
        CHARISMA_DATA.forEach(gift => {
            const isUnlocked = state.found_ids.includes(gift.id);
            const x = gift.pos.x;
            const y = gift.pos.y;

            // Glow Effect for Unlocked
            if (isUnlocked) {
                const gradient = ctx.createRadialGradient(x, y, 10, x, y, 40);
                gradient.addColorStop(0, "rgba(16, 185, 129, 0.6)"); // Emerald
                gradient.addColorStop(1, "rgba(0,0,0,0)");
                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(x, y, 40, 0, Math.PI * 2);
                ctx.fill();
            }

            // Circle Body
            ctx.beginPath();
            ctx.arc(x, y, 25, 0, Math.PI * 2);
            ctx.fillStyle = isUnlocked ? "#064e3b" : "#1f2937"; // Green or Gray
            ctx.strokeStyle = isUnlocked ? "#34d399" : "#fbbf24";
            ctx.lineWidth = 3;
            ctx.fill();
            ctx.stroke();

            // Text/Icon
            ctx.font = "20px Arial";
            ctx.textAlign = "center";
            ctx.textBaseline = "middle";
            ctx.fillText(gift.icon, x, y + 2);

            // Label
            ctx.font = "14px Arial";
            ctx.fillStyle = isUnlocked ? "#fff" : "#aaa";
            ctx.fillText(gift.name, x, y + 45);
        });

        // 3. Draw Particles (Visual Feedback)
        drawParticles();
    }

    // --- PARTICLE SYSTEM ---
    function createParticles(x, y) {
        for(let i=0; i<15; i++) {
            state.particles.push({
                x: x, y: y,
                vx: (Math.random() - 0.5) * 5,
                vy: (Math.random() - 0.5) * 5,
                life: 1.0,
                color: `hsl(${Math.random()*60 + 40}, 100%, 50%)` // Gold/Yellow
            });
        }
    }

    function drawParticles() {
        for (let i = state.particles.length - 1; i >= 0; i--) {
            let p = state.particles[i];
            p.x += p.vx;
            p.y += p.vy;
            p.life -= 0.02;

            ctx.globalAlpha = p.life;
            ctx.fillStyle = p.color;
            ctx.beginPath();
            ctx.arc(p.x, p.y, 3, 0, Math.PI*2);
            ctx.fill();
            ctx.globalAlpha = 1.0;

            if(p.life <= 0) state.particles.splice(i, 1);
        }
        if(state.particles.length > 0) requestAnimationFrame(drawHill);
    }

    // --- INTERACTION LOGIC ---

    function initGrid() {
        const grid = document.getElementById('charisma-grid');
        grid.innerHTML = ''; // Clear

        CHARISMA_DATA.forEach(gift => {
            const card = document.createElement('div');
            card.id = `card-${gift.id}`;
            card.className = `locked bg-zinc-900 border border-zinc-700 rounded-2xl p-6 transition-all duration-500`;
            card.innerHTML = `
                <div class="flex justify-between items-start mb-4">
                    <div class="text-4xl filter drop-shadow-md">${gift.icon}</div>
                    <div class="bg-black/50 px-3 py-1 rounded text-xs text-yellow-500 font-mono">ID: ${gift.id.toUpperCase()}</div>
                </div>
                <h3 class="text-2xl font-bold text-white mb-2">${gift.name}</h3>
                <p class="text-gray-400 text-sm leading-relaxed mb-4 min-h-[80px]">${gift.text}</p>
                <div class="border-t border-white/10 pt-4 flex justify-between items-center">
                    <span class="text-xs text-gray-500">GRACE COST: ${gift.stats.cost}</span>
                    <span class="text-emerald-400 font-bold">+${gift.stats.grace} XP</span>
                </div>
            `;
            grid.appendChild(card);
        });
    }

    function unlockGift(gift) {
        // Update Logic
        state.found_ids.push(gift.id);
        state.score += gift.stats.grace;

        // UI Updates
        document.getElementById('velo-score').innerText = state.score;
        document.getElementById('found-count').innerText = `${state.found_ids.length}/7`;
        document.getElementById('start-hint').style.opacity = '0';

        // Unlock Card in Grid
        const card = document.getElementById(`card-${gift.id}`);
        if(card) {
            card.classList.remove('locked');
            card.classList.add('unlocked', 'glow-box');
        }

        // SFX
        createParticles(gift.pos.x, gift.pos.y);
        const sfx = state.found_ids.length === 7 ? document.getElementById('sfx-win') : document.getElementById('sfx-bell');
        sfx.currentTime = 0;
        sfx.play();

        // Redraw Canvas
        drawHill();
    }

    // Click Handler
    canvas.addEventListener('mousedown', (e) => {
        const rect = canvas.getBoundingClientRect();
        // Scale for responsiveness
        const scaleX = canvas.width / rect.width;
        const scaleY = canvas.height / rect.height;
        
        const clickX = (e.clientX - rect.left) * scaleX;
        const clickY = (e.clientY - rect.top) * scaleY;

        CHARISMA_DATA.forEach(gift => {
            const dx = clickX - gift.pos.x;
            const dy = clickY - gift.pos.y;
            const distance = Math.sqrt(dx*dx + dy*dy);

            if(distance < 30) {
                if(!state.found_ids.includes(gift.id)) {
                    unlockGift(gift);
                }
            }
        });
    });

    // --- INITIALIZATION ---
    window.onload = () => {
        initGrid();
        drawHill();
    };

  </script>
</body>
</html>
